# EDA проекта: Предсказание покупки на сайте (Online Shoppers Intention)

## О проекте

Данный проект представляет собой разведочный анализ данных (EDA) для набора данных `online_shoppers_intention`. Основная цель — исследовать данные о поведении пользователей на сайте и выявить факторы, влияющие на совершение покупки (целевая переменная `Revenue`).

**Задачи проекта:**
1.  Провести общее исследование структуры и качества данных.
2.  Выполнить однофакторный анализ переменных, включая обработку аномалий и анализ связи с целевой переменной.
3.  Исследовать взаимосвязи между признаками с помощью матрицы корреляций и статистических тестов.
4.  Проанализировать распределение целевой переменной и выявить потенциальные проблемы для моделирования.
5.  Сравнить производительность библиотек Pandas и Polars на искусственно увеличенном датасете.

## Структура проекта

*   `online_shoppers_intention.ipynb` — основной Jupyter Notebook с кодом EDA и выводами.
*   `online_shoppers_intention.csv` — исходный файл с данными.
*   `README.md` — данный файл с описанием проекта.

## Основные этапы и выводы

### 1. Общее исследование данных

*   Загружены данные, изучены размеры датафрейма, типы данных, наличие пропусков.

*   Исходный датасет содержит 12330 строк и 18 столбцов.

*   В датасете обноружено 109 повторяющихся строк. Так как они составляют малую часть (<1%), было принято решение удалить их.


### 2. Однофакторный анализ переменных

*   Отсутсвующие значения заменены реальными: в `Informational_Duration` использовал моду (т.к. 80% `0`), `ProductRelated_Duration` и `ExitRates` заполнил медианой, чтобы нивелировать выбросы.

*   Распределения числовых признаков не являются нормальными. При логарифмировании, ситуация несколько улучшилась, однако на графиках всё ещё имеются выбросы. Возможно стоит срезать такие значения.

*   Стоит обратить внимание на дизбаланс классов. Целевая переменная (Revenue), имеет лишь 16% значений имеют `True`. Стоит поработать над дизбалансом классов, так как это серьёзная проблема. Существует несколько вариантов решения данной проблемы: можно изменить размер датасета (с целью балансировки классов), или же при обучении модели задать классам веса. Альтернативой является использование метрик, устойчивым к дизбалансу классов, например F1. 

*   Что же касается графической составляющей анализа, наиболее показательным является зависимость просмотренных страниц (PageValues) от целевой переменной (Revenue). Визуально видна связь - при большом объёме просмотренных страниц, число положительных исходов (True) кратно превышает отрицательные. 


### 3. Взаимосвязи между признаками

*   Матрица корреляций подтверждает нашу предыдущую гипотезу. Действительно, между Revenue и PagesValues имеется заметная корреляция (сильной, конечно, её нельзя назвать, но она выделяется среди остальных) - 0,59. 
    Также можно попробовать оставить признаки с модулем корреляции >0.1, а остальные удалить. Ибо переменные без значительной связи не являются для нас полезными, а наоборот, могут даже снижать точность модели

*   Также из-за наличия очень схожих признаков, может быть полезно посмотреть на VIF. По возможности удалить ненужные (с кросс-корреляцией).

*   Анализ с помощью ANOVA не имеет смысла, так как целевая переменная бинарна.

### 4. Анализ целевой переменной Revenue

*   Переменная Revenue имеет биноминальное распределение (т.к. принимаемые значения 1 (True) и 0(False)). 

*   Имеется дизбаланс классов, о котором говорилось в п. 2. Однофакторный анализ переменных

### 5. Сравнение Pandas и Polars

*   Polars показывает ощутимое преимущество по скорости и по использованию памяти при обработке больших таблиц и при ленивых (lazy) операциях.

*   Pandas имеет более знакомый синтаксис, а также предоставляет более уверенную интеграцию с другими библиотеками. 